#VRML_SIM R2023b utf8
# tags: static

PROTO Drive [
  field SFVec3f    translation  0 0 0
  field SFRotation rotation     0 0 1 0
  field SFString   name   "drive"
  field SFFloat    axisResolution -1
  field SFFloat    wheelResolution -1
  field SFFloat    axisMaxVelocity 20
  field SFFloat    wheelMaxVelocity 20
  field SFString   wheelContactMaterial "wheel"
]
{
  Pose {
    translation IS translation
    rotation IS rotation
    children [
      HingeJoint {
        jointParameters HingeJointParameters {
          axis 0 0 1
          anchor 0 0 0.1
        }
        device [
          RotationalMotor {
            name %{= '"' .. fields.name.value .. ' axis motor"' }%
            maxVelocity IS axisMaxVelocity
          }
          PositionSensor {
            name %{= '"' .. fields.name.value .. ' axis sensor"' }%
            resolution IS axisResolution
          }
        ]
        endPoint Solid {
          name IS name
          children [
              CadShape {
                url "../swerve frame.dae"
              }
              HingeJoint {
                jointParameters HingeJointParameters {
                  axis 0 1 0
                  anchor 0 0 0.04
                }
                device [
                  RotationalMotor {
                    name %{= '"' .. fields.name.value .. ' wheel motor"' }%
                    maxVelocity IS wheelMaxVelocity
                  }
                  PositionSensor {
                    name %{= '"' .. fields.name.value .. ' wheel sensor"' }%
                    resolution IS wheelResolution
                  }
                ]
                endPoint Solid {
                  children [
                    CadShape {
                      url "../swerve wheel.dae"
                    }
                  ]
                  boundingObject Pose {
                    translation 0 0 0.04
                    rotation 1 0 0 %{= math.pi / 2 }%
                    children [
                      Cylinder {
                        height 0.025
                        radius 0.04
                        subdivision 24
                      }
                    ]
                  }
                  contactMaterial IS wheelContactMaterial
                  physics Physics {
                  }
                }
              }
          ]
          boundingObject Pose {
            translation 0 0 0.065
            children [
              Box {
                size 0.04 0.05 0.07
              }
            ]
          }
          physics Physics {
          }
        }
      }
    ]
  }
}